<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Сборка компьютера</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <h1>Сборка компьютера</h1>

    <form action="/save-computer-sbor" method="post">
        <!-- 1) Материнская плата -->
        <div>
            <h3>1) Материнская плата</h3>
            <label for="brand1">Бренд:</label>
            <select id="brand1" name="brand1">
                <option th:each="brand : ${brands}" th:value="${brand.id}" th:text="${brand.brandName}"></option>
            </select>

            <label for="model1">Модель:</label>
            <select id="model1" name="modelId1">
                <option value="">Сначала выберите бренд</option>
            </select>

            <label for="part1">Комплектующая:</label>
            <select id="part1" name="partId1">
                <option value="">Сначала выберите модель</option>
            </select>
        </div>

        <!-- 2) Процессор -->
        <div>
            <h3>2) Процессор</h3>
            <label for="brand2">Бренд:</label>
            <select id="brand2" name="brand2">
                <option th:each="brand : ${brands}" th:value="${brand.id}" th:text="${brand.brandName}"></option>
            </select>

            <label for="model2">Модель:</label>
            <select id="model2" name="modelId2">
                <option value="">Сначала выберите бренд</option>
            </select>

            <label for="part2">Комплектующая:</label>
            <select id="part2" name="partId2">
                <option value="">Сначала выберите модель</option>
            </select>
        </div>

        <!-- 3) Оперативная память -->
        <div>
            <h3>3) Оперативная память</h3>
            <label for="brand3">Бренд:</label>
            <select id="brand3" name="brand3">
                <option th:each="brand : ${brands}" th:value="${brand.id}" th:text="${brand.brandName}"></option>
            </select>

            <label for="model3">Модель:</label>
            <select id="model3" name="modelId3">
                <option value="">Сначала выберите бренд</option>
            </select>

            <label for="part3">Комплектующая:</label>
            <select id="part3" name="partId3">
                <option value="">Сначала выберите модель</option>
            </select>
        </div>

        <!-- 4) Видеокарта -->
        <div>
            <h3>4) Видеокарта</h3>
            <label for="brand4">Бренд:</label>
            <select id="brand4" name="brand4">
                <option th:each="brand : ${brands}" th:value="${brand.id}" th:text="${brand.brandName}"></option>
            </select>

            <label for="model4">Модель:</label>
            <select id="model4" name="modelId4">
                <option value="">Сначала выберите бренд</option>
            </select>

            <label for="part4">Комплектующая:</label>
            <select id="part4" name="partId4">
                <option value="">Сначала выберите модель</option>
            </select>
        </div>

        <!-- 5) Блок питания -->
        <div>
            <h3>5) Блок питания</h3>
            <label for="brand5">Бренд:</label>
            <select id="brand5" name="brand5">
                <option th:each="brand : ${brands}" th:value="${brand.id}" th:text="${brand.brandName}"></option>
            </select>

            <label for="model5">Модель:</label>
            <select id="model5" name="modelId5">
                <option value="">Сначала выберите бренд</option>
            </select>

            <label for="part5">Комплектующая:</label>
            <select id="part5" name="partId5">
                <option value="">Сначала выберите модель</option>
            </select>
        </div>

        <!-- 6) Накопитель -->
        <div>
            <h3>6) Накопитель</h3>
            <label for="brand6">Бренд:</label>
            <select id="brand6" name="brand6">
                <option th:each="brand : ${brands}" th:value="${brand.id}" th:text="${brand.brandName}"></option>
            </select>

            <label for="model6">Модель:</label>
            <select id="model6" name="modelId6">
                <option value="">Сначала выберите бренд</option>
            </select>

            <label for="part6">Комплектующая:</label>
            <select id="part6" name="partId6">
                <option value="">Сначала выберите модель</option>
            </select>
        </div>

        <button type="submit">Собрать компьютер</button>
    </form>

    <script>
        $(document).ready(function () {
            // Универсальные функции для обновления списков
            function updateModels(brandSelector, modelSelector, partSelector) {
                $(brandSelector).on('change', function () {
                    let brandId = $(this).val();
                    if (brandId) {
                        $.post('/get-models', {brandId: brandId}, function (data) {
                            $(modelSelector).html(data);
                            $(partSelector).html('<option value="">Сначала выберите модель</option>');
                        });
                    } else {
                        $(modelSelector).html('<option value="">Сначала выберите бренд</option>');
                        $(partSelector).html('<option value="">Сначала выберите модель</option>');
                    }
                });
            }

            function updateParts(modelSelector, partSelector) {
                $(modelSelector).on('change', function () {
                    let modelId = $(this).val();
                    if (modelId) {
                        $.post('/get-parts', {modelId: modelId}, function (data) {
                            $(partSelector).html(data);
                        });
                    } else {
                        $(partSelector).html('<option value="">Сначала выберите модель</option>');
                    }
                });
            }

            // Инициализация для всех 6 позиций
            for (let i = 1; i <= 6; i++) {
                updateModels('#brand' + i, '#model' + i, '#part' + i);
                updateParts('#model' + i, '#part' + i);
            }
        });
    </script>
</body>
</html>

